<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bootstrap Confidence Interval for Standardized Solution in lavaan • semhelpinghands</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap Confidence Interval for Standardized Solution in lavaan">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">semhelpinghands</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/semhelpinghands.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/plot_boot.html">Diagnostic Plots of Bootstrap Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/standardizedSolution_boot_ci.html">Bootstrap Confidence Interval for Standardized Solution in lavaan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/semhelpinghands/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap Confidence Interval for Standardized Solution in lavaan</h1>
                        <h4 data-toc-skip class="author">Shu Fai
Cheung</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/semhelpinghands/blob/v0.1.12/vignettes/standardizedSolution_boot_ci.Rmd" class="external-link"><code>vignettes/standardizedSolution_boot_ci.Rmd</code></a></small>
      <div class="d-none name"><code>standardizedSolution_boot_ci.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document introduces the function
<code><a href="../reference/standardizedSolution_boot_ci.html">standardizedSolution_boot_ci()</a></code>, and related helpers, from
the package <a href="https://sfcheung.github.io/semhelpinghands/"><code>semhelpinghands</code></a>.</p>
</div>
<div class="section level2">
<h2 id="what-standardizedsolution_boot_ci-does">What <code>standardizedSolution_boot_ci()</code> Does<a class="anchor" aria-label="anchor" href="#what-standardizedsolution_boot_ci-does"></a>
</h2>
<p>In <code>lavaan</code>, even with <code>se = "bootstrap"</code>, the
confidence intervals in the standardized solution are <em>not</em>
bootstrap confidence intervals. This is a problem when researchers want
to form bootstrap confidence intervals for parameters such as a
<em>standardized</em> indirect effect.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;In &lt;code&gt;lavaan&lt;/code&gt;, if bootstrapping is requested,
the standard errors and confidence intervals in the standardized
solutions are computed by delta method using the variance-covariance
matrix of the bootstrap estimates. The intervals are symmetric about the
point estimates and are not the bootstrap percentile confidence
intervals users expect when bootstrapping is conducted.&lt;/p&gt;"><sup>1</sup></a></p>
<p>The function <code><a href="../reference/standardizedSolution_boot_ci.html">standardizedSolution_boot_ci()</a></code> addresses
this problem. It accepts a <code>lavaan::lavaan-class</code> object
fitted with <code>se = "bootstrap"</code> (or <code>se = "boot"</code>)
and forms the percentile confidence intervals based on the bootstrap
estimates stored in the object.</p>
</div>
<div class="section level2">
<h2 id="data-and-model">Data and Model<a class="anchor" aria-label="anchor" href="#data-and-model"></a>
</h2>
<p>A mediation model example modified from the official
<code>lavaan</code> website is used (<a href="https://lavaan.ugent.be/tutorial/mediation.html" class="external-link uri">https://lavaan.ugent.be/tutorial/mediation.html</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># X drawn from a Chi-square distribution with df = 2</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="va">n</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">.40</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">.40</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">.30</span> <span class="op">*</span> <span class="va">M</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">.30</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>,</span>
<span>                   Y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>                   M <span class="op">=</span> <span class="va">M</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st"># direct effect</span></span>
<span><span class="st">  Y ~ c*X</span></span>
<span><span class="st"># mediator</span></span>
<span><span class="st">  M ~ a*X</span></span>
<span><span class="st">  Y ~ b*M</span></span>
<span><span class="st"># indirect effect (a*b)</span></span>
<span><span class="st">  ab := a*b</span></span>
<span><span class="st"># total effect</span></span>
<span><span class="st">  total := c + (a*b)</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>This model is fitted with <code>se = "bootstrap"</code> and 5000
replication. (Change <code>ncpus</code> to a value appropriate for the
system running it.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>           data <span class="op">=</span> <span class="va">Data</span>,</span>
<span>           se <span class="op">=</span> <span class="st">"bootstrap"</span>,</span>
<span>           bootstrap <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>           parallel <span class="op">=</span> <span class="st">"snow"</span>,</span>
<span>           ncpus <span class="op">=</span> <span class="fl">4</span>,</span>
<span>           iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<p>(Note that having a warning for some bootstrap runs is normal. The
failed runs will not be used in forming the confidence intervals.)</p>
<p>This is the standardized solution with delta-method confidence
intervals.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">standardizedSolution</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;     lhs op     rhs label est.std    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1     Y  ~       X     c   0.054 0.118  0.461  0.645   -0.176    0.285</span></span>
<span><span class="co">#&gt; 2     M  ~       X     a   0.370 0.098  3.768  0.000    0.178    0.563</span></span>
<span><span class="co">#&gt; 3     Y  ~       M     b   0.255 0.097  2.622  0.009    0.064    0.446</span></span>
<span><span class="co">#&gt; 4     Y ~~       Y         0.922 0.055 16.653  0.000    0.813    1.030</span></span>
<span><span class="co">#&gt; 5     M ~~       M         0.863 0.073 11.866  0.000    0.720    1.006</span></span>
<span><span class="co">#&gt; 6     X ~~       X         1.000 0.000     NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 7    ab :=     a*b    ab   0.094 0.045  2.093  0.036    0.006    0.183</span></span>
<span><span class="co">#&gt; 8 total := c+(a*b) total   0.149 0.108  1.375  0.169   -0.063    0.361</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bootstrap-percentile-cis-for-standardized-solution">Bootstrap Percentile CIs for Standardized Solution<a class="anchor" aria-label="anchor" href="#bootstrap-percentile-cis-for-standardized-solution"></a>
</h2>
<p>To form bootstrap percentile confidence intervals for the
standardized solution, simply use
<code><a href="../reference/standardizedSolution_boot_ci.html">standardizedSolution_boot_ci()</a></code> instead of
<code><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">lavaan::standardizedSolution()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/semhelpinghands/">semhelpinghands</a></span><span class="op">)</span></span>
<span><span class="va">ci_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardizedSolution_boot_ci.html">standardizedSolution_boot_ci</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">ci_boot</span></span>
<span><span class="co">#&gt;     lhs op     rhs label est.std    se      z pvalue ci.lower ci.upper</span></span>
<span><span class="co">#&gt; 1     Y  ~       X     c   0.054 0.118  0.461  0.645   -0.176    0.285</span></span>
<span><span class="co">#&gt; 2     M  ~       X     a   0.370 0.098  3.768  0.000    0.178    0.563</span></span>
<span><span class="co">#&gt; 3     Y  ~       M     b   0.255 0.097  2.622  0.009    0.064    0.446</span></span>
<span><span class="co">#&gt; 4     Y ~~       Y         0.922 0.055 16.653  0.000    0.813    1.030</span></span>
<span><span class="co">#&gt; 5     M ~~       M         0.863 0.073 11.866  0.000    0.720    1.006</span></span>
<span><span class="co">#&gt; 6     X ~~       X         1.000 0.000     NA     NA    1.000    1.000</span></span>
<span><span class="co">#&gt; 7    ab :=     a*b    ab   0.094 0.045  2.093  0.036    0.006    0.183</span></span>
<span><span class="co">#&gt; 8 total := c+(a*b) total   0.149 0.108  1.375  0.169   -0.063    0.361</span></span>
<span><span class="co">#&gt;   boot.ci.lower boot.ci.upper boot.se</span></span>
<span><span class="co">#&gt; 1        -0.171         0.286   0.117</span></span>
<span><span class="co">#&gt; 2         0.144         0.537   0.101</span></span>
<span><span class="co">#&gt; 3         0.061         0.443   0.097</span></span>
<span><span class="co">#&gt; 4         0.766         0.986   0.058</span></span>
<span><span class="co">#&gt; 5         0.712         0.979   0.070</span></span>
<span><span class="co">#&gt; 6            NA            NA      NA</span></span>
<span><span class="co">#&gt; 7         0.016         0.202   0.047</span></span>
<span><span class="co">#&gt; 8        -0.048         0.362   0.106</span></span></code></pre></div>
<p>The bootstrap percentile confidence intervals are appended to the
right of the original output of
<code><a href="https://rdrr.io/pkg/lavaan/man/standardizedSolution.html" class="external-link">lavaan::standardizedSolution()</a></code>, in columns
<code>boot.ci.lower</code> and <code>boot.ci.upper</code>. The standard
errors based on the bootstrap estimates (the standard deviation of the
estimates) are listed on the column <code>boot.se</code>.</p>
<p>As expected, the bootstrap percentile confidence interval of the
indirect effect, <code>ab</code>, is [0.016, 0.202], wider than the
delta-method confidence interval, [0.006, 0.183], and is shifted to the
right.</p>
</div>
<div class="section level2">
<h2 id="print-in-a-friendly-format">Print in a Friendly Format<a class="anchor" aria-label="anchor" href="#print-in-a-friendly-format"></a>
</h2>
<p>The print-method of the output of
<code><a href="../reference/standardizedSolution_boot_ci.html">standardizedSolution_boot_ci()</a></code> supports printing the
results in a text Format similar to the summary of <code>lavaan</code>
output. Call <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> directly and add
<code>output = "text"</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_boot</span>,</span>
<span>      output <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Estimates Only</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                            Bootstrap</span></span>
<span><span class="co">#&gt;   Confidence interval                        Bootstrap</span></span>
<span><span class="co">#&gt;   Confidence Level                               95.0%</span></span>
<span><span class="co">#&gt;   Standardization Type                         std.all</span></span>
<span><span class="co">#&gt;   Number of requested bootstrap draws             5000</span></span>
<span><span class="co">#&gt;   Number of successful bootstrap draws            5000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                Standardized  Std.Err ci.lower ci.upper</span></span>
<span><span class="co">#&gt;   Y ~                                                 </span></span>
<span><span class="co">#&gt;     X          (c)    0.054    0.117   -0.171    0.286</span></span>
<span><span class="co">#&gt;   M ~                                                 </span></span>
<span><span class="co">#&gt;     X          (a)    0.370    0.101    0.144    0.537</span></span>
<span><span class="co">#&gt;   Y ~                                                 </span></span>
<span><span class="co">#&gt;     M          (b)    0.255    0.097    0.061    0.443</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                Standardized  Std.Err ci.lower ci.upper</span></span>
<span><span class="co">#&gt;    .Y                 0.922    0.058    0.766    0.986</span></span>
<span><span class="co">#&gt;    .M                 0.863    0.070    0.712    0.979</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Defined Parameters:</span></span>
<span><span class="co">#&gt;                Standardized  Std.Err ci.lower ci.upper</span></span>
<span><span class="co">#&gt;     ab                0.094    0.047    0.016    0.202</span></span>
<span><span class="co">#&gt;     total             0.149    0.106   -0.048    0.362</span></span></code></pre></div>
<p>Note that it will replace the results of <em>unstandardized</em>
solution by those from the <em>standardized</em> solution.</p>
<p>To print both the unstandardized and standardized results in the
text-format, add <code>standardized_only = FALSE</code> when calling
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p>The function <code><a href="../reference/standardizedSolution_boot_ci.html">standardizedSolution_boot_ci()</a></code> takes some
time to run because it retrieves the estimates of the unstandardized
solution in each bootstrap sample and computes the estimates in the
standardized solution. Therefore, if 5,000 bootstrap samples are
requested, this process is repeated 5,000 times. Nevertheless, it is
still much faster than fitting the model 5,000 times again.</p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This function was originally proposed in an <a href="https://github.com/simsem/semTools/issues/101#issue-1021974657" class="external-link">issue
at GitHub</a>, inspired by a discussion at the <a href="https://groups.google.com/g/lavaan/c/qQBXSz5cd0o/m/R8YT5HxNAgAJ" class="external-link">Google
group for lavaan</a>. It is not a versatile function and used some
“tricks” to do the work. A more reliable way is to use function like
<code><a href="https://rdrr.io/pkg/lavaan/man/bootstrap.html" class="external-link">lavaan::bootstrapLavaan()</a></code>. Nevertheless, this simple
function is good enough for the cases I encountered in my work.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
